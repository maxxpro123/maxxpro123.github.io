<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>VR Mini Game</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
</head>
<body>
  <a-scene>
    <a-assets>
      <img id="sky" src="sky.png">
      <img id="ground" src="ground.jpg">
    </a-assets>
    
    <!-- Небо -->
    <a-sky src="#sky"></a-sky>

    <a-entity id="player" >
      <a-entity collider-check raycaster="objects: .collidable; showLine:true;" position="0 1 0"></a-entity>
    </a-entity>
      <a-entity class="collidable" geometry="primitive: box"  position="0 1 -3"> 
    </a-entity>>
    
    <!-- Пол -->
    <a-plane src="#ground"
      position="0 0 -4" 
      rotation="-90 0 0" 
      width="100" 
      height="100">
    </a-plane>

    <!-- Текст для отображения счета -->
    <a-text 
      id="scoreText"
      value="Score: 0" 
      position="-1.5 2.5 -5" 
      color="black">
    </a-text>

    <!-- Таймер -->
    <a-text 
      id="timer" 
      value="Time: 120" 
      position="1.5 2.5 -5" 
      color="black">
    </a-text>

    <!-- Объекты для сбора (сферы) -->
    <script>
      const numSpheres = 20; // количество сфер
      const scene = document.querySelector('a-scene');
      let score = 0; // начальное количество очков
      let timeLeft = 120; // время в секундах

      
      function createSpheres() {
        for (let i = 0; i < numSpheres; i++) {
          const sphere = document.createElement('a-sphere');
          sphere.setAttribute('radius', '0.5'); // радиус сферы
          sphere.setAttribute('color', '#EF2D5E'); // цвет сферы
          sphere.setAttribute('class', 'collectible'); // класс для коллизии

          
          const x = (Math.random() - 0.5) * 100; // случайное значение от -50 до 50
          const z = (Math.random() - 0.5) * -100; // случайное значение от -50 до 0
          sphere.setAttribute('position', `${x} 1.25 ${z}`);

          
          sphere.addEventListener('collide', function (event) {
            if (event.detail.body.el.id === 'player') {
              scene.removeChild(sphere); // Удаление сферы из сцены
              score++; // Увеличение счета
              document.getElementById('scoreText').setAttribute('value', `Score: ${score}`); // Обновление текста счета
            }
          });

          scene.appendChild(sphere); // добавление сферы в сцену
        }
      }

      
      function updateTimer() {
        if (timeLeft > 0) {
          timeLeft--;
          document.getElementById('timer').setAttribute('value', `Time: ${timeLeft}`);
        } else {
          clearInterval(timerInterval);
          alert("Время вышло! Ваш счет: " + score);
        }
      }

      
      createSpheres(); 
      const timerInterval = setInterval(updateTimer, 1000); 

    </script>

  </a-scene>
</body>
</html>
